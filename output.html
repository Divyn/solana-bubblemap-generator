<!doctype html>
<meta charset="utf-8" />
<title>Solana Bubble Map</title>
<style>
  body { margin: 0; font-family: system-ui, sans-serif; }
  svg { width: 100vw; height: 100vh; background: #0b0f17; }
  .link { stroke: rgba(255,255,255,0.2); }
  .node { stroke: #111; stroke-width: 1px; }
  .label { fill: #ddd; font-size: 10px; pointer-events: none; }
  .legend { position: fixed; left: 12px; top: 12px; color: #ccc; }
  .legend b { color: #fff; }
  @media (prefers-contrast: more) { .link { stroke: rgba(255,255,255,0.4); } }
  .tooltip {
    position: fixed;
    z-index: 10;
    display: none;
    max-width: 320px;
    color: #e6edf3;
    background: rgba(13, 17, 23, 0.92);
    border: 1px solid rgba(255,255,255,0.15);
    border-radius: 8px;
    box-shadow: 0 6px 24px rgba(0,0,0,0.35);
    padding: 10px 12px;
    font-size: 12px;
    line-height: 1.35;
    pointer-events: none;
    backdrop-filter: blur(4px);
  }
  .tooltip .title { font-weight: 600; margin-bottom: 4px; color: #fff; }
  .tooltip .row { display: flex; justify-content: space-between; gap: 12px; }
  .tooltip .muted { color: #9aa4b2; }
</style>
<div class="legend">Solana Bubble Map — <b>Size</b>: node USD volume, <b>Width</b>: link USD</div>
<svg></svg>
<div id="tooltip" class="tooltip"></div>
<script type="module">
import * as d3 from 'https://cdn.jsdelivr.net/npm/d3@7/+esm';

const width = window.innerWidth;
const height = window.innerHeight;
const svg = d3.select('svg');

const data = {
  "nodes": [
    {
      "id": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "label": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 323810.9631999994
    },
    {
      "id": "7C7Y3fyPYeAYqpc29uahDUQ84PQ255Avj2YEP9KpvyKx",
      "label": "7C7Y3fyPYeAYqpc29uahDUQ84PQ255Avj2YEP9KpvyKx",
      "value": 238746.35638499996
    },
    {
      "id": "ExwyJ1D3F4RwaRvpGhmendPFK7Jfiqjh7a1TcQzt4Sq",
      "label": "ExwyJ1D3F4RwaRvpGhmendPFK7Jfiqjh7a1TcQzt4Sq",
      "value": 20211.689059
    },
    {
      "id": "8sJpY3PDTpSdaHrWmJ2woAXQJLHs1S4HQxcEcievcoLo",
      "label": "8sJpY3PDTpSdaHrWmJ2woAXQJLHs1S4HQxcEcievcoLo",
      "value": 8823.532621999999
    },
    {
      "id": "FkEB6uvyzuoaGpgs4yRtFtxC4WJxhejNFbUkj5R6wR32",
      "label": "FkEB6uvyzuoaGpgs4yRtFtxC4WJxhejNFbUkj5R6wR32",
      "value": 7789.233826000001
    },
    {
      "id": "6ZaWyb9PKP1ZGVsQcE9vjnGPCH6KiWE5XLUY7HdNEJ77",
      "label": "6ZaWyb9PKP1ZGVsQcE9vjnGPCH6KiWE5XLUY7HdNEJ77",
      "value": 7246.043169
    },
    {
      "id": "7imnGYfCovXjMWKdbQvETFVMe72MQDX4S5zW4GFxMJME",
      "label": "7imnGYfCovXjMWKdbQvETFVMe72MQDX4S5zW4GFxMJME",
      "value": 6928.347925
    },
    {
      "id": "FDJKUgZniCHAgzeDfcx1rvhHZER1yEnnyvFRvMuofiSP",
      "label": "FDJKUgZniCHAgzeDfcx1rvhHZER1yEnnyvFRvMuofiSP",
      "value": 6760.066474
    },
    {
      "id": "4BXpSHpJa6EbgQgGWV8bQVw9t1VijGXBXzYY8m6v969V",
      "label": "4BXpSHpJa6EbgQgGWV8bQVw9t1VijGXBXzYY8m6v969V",
      "value": 4422.46426
    },
    {
      "id": "E6xrCvWbvX8DNuCp5ztKdhFPv3AZisGre8FtTx4DCNTF",
      "label": "E6xrCvWbvX8DNuCp5ztKdhFPv3AZisGre8FtTx4DCNTF",
      "value": 4256.6710969999995
    },
    {
      "id": "6y33H5c1FUYego5mL9CghGrqj77PC7ieevMyuNqbCvfP",
      "label": "6y33H5c1FUYego5mL9CghGrqj77PC7ieevMyuNqbCvfP",
      "value": 3013.1566729999995
    },
    {
      "id": "BXh9wNMJ9g3tCKgjr9E9KiSa7VRdDKspXh1uYEEA6xhW",
      "label": "BXh9wNMJ9g3tCKgjr9E9KiSa7VRdDKspXh1uYEEA6xhW",
      "value": 2999.4
    },
    {
      "id": "22HUWiJaTNph96KQTKZVy2wg8KzfCems5nyW7E5H5J6w",
      "label": "22HUWiJaTNph96KQTKZVy2wg8KzfCems5nyW7E5H5J6w",
      "value": 1918.668022
    },
    {
      "id": "3nMFwZXwY1s1M5s8vYAHqd4wGs4iSxXE4LRoUMMYqEgF",
      "label": "3nMFwZXwY1s1M5s8vYAHqd4wGs4iSxXE4LRoUMMYqEgF",
      "value": 1104.814665
    },
    {
      "id": "4SAZfdHATLCgdtCArEAryxcvRWEKFmPuEqr72hyCRLJt",
      "label": "4SAZfdHATLCgdtCArEAryxcvRWEKFmPuEqr72hyCRLJt",
      "value": 1025
    },
    {
      "id": "2B24UFbvKwSqAzsqZX9rad2gqFmNoeE6B8uCFW6tpEzY",
      "label": "2B24UFbvKwSqAzsqZX9rad2gqFmNoeE6B8uCFW6tpEzY",
      "value": 1000.5
    },
    {
      "id": "F8A9VK67WeWKruZfBxRRuZUsQ9BZnBFF4A35bx976ob5",
      "label": "F8A9VK67WeWKruZfBxRRuZUsQ9BZnBFF4A35bx976ob5",
      "value": 900
    },
    {
      "id": "4ZgJn35Y1h1jWdv4iYdyjphPk4ZaMi8FgoLw17wGBHm3",
      "label": "4ZgJn35Y1h1jWdv4iYdyjphPk4ZaMi8FgoLw17wGBHm3",
      "value": 850
    },
    {
      "id": "7o67HYcMuKAUWq1PF4B1SKG9HesR7u9N3ukuFxhKXFfh",
      "label": "7o67HYcMuKAUWq1PF4B1SKG9HesR7u9N3ukuFxhKXFfh",
      "value": 605.182583
    },
    {
      "id": "CtshJv4S924Lkdh8uvcQDEtUv4WDTZrVpND7cYP2tMPZ",
      "label": "CtshJv4S924Lkdh8uvcQDEtUv4WDTZrVpND7cYP2tMPZ",
      "value": 604.874603
    },
    {
      "id": "F2oSLY4gXwi4cLFripL15iTSZczhkKzYfbRhs2PdAQxy",
      "label": "F2oSLY4gXwi4cLFripL15iTSZczhkKzYfbRhs2PdAQxy",
      "value": 600
    },
    {
      "id": "3NrRxkTvbW3dpGu9JBCeY6PvY6J9Vg4BUhqETvGCSm7c",
      "label": "3NrRxkTvbW3dpGu9JBCeY6PvY6J9Vg4BUhqETvGCSm7c",
      "value": 532
    },
    {
      "id": "7gEQ6syDZmyPE4JdfJm4qatawnDqvqdh6i8jJjCXio6h",
      "label": "7gEQ6syDZmyPE4JdfJm4qatawnDqvqdh6i8jJjCXio6h",
      "value": 362
    },
    {
      "id": "FwewVm8u6tFPGewAyHmWAqad9hmF7mvqxK4mJ7iNqqGC",
      "label": "FwewVm8u6tFPGewAyHmWAqad9hmF7mvqxK4mJ7iNqqGC",
      "value": 342.581175
    },
    {
      "id": "HQCbyLb9zzFQENNhsuZ2cbMScevAYzyJPeRhsDZuYgup",
      "label": "HQCbyLb9zzFQENNhsuZ2cbMScevAYzyJPeRhsDZuYgup",
      "value": 300
    },
    {
      "id": "F7p3dFrjRTbtRp8FRF6qHLomXbKRBzpvBLjtQcfcgmNe",
      "label": "F7p3dFrjRTbtRp8FRF6qHLomXbKRBzpvBLjtQcfcgmNe",
      "value": 289.399784
    },
    {
      "id": "GF8SKKobum6UJnhX2mLHePU38htg5vdr9zcY4jH8Pqs2",
      "label": "GF8SKKobum6UJnhX2mLHePU38htg5vdr9zcY4jH8Pqs2",
      "value": 233.96793700000003
    },
    {
      "id": "Fm4NdDhcrS9a8ceHJGe6okjLdHUB1sLhGyjzzijaKzUf",
      "label": "Fm4NdDhcrS9a8ceHJGe6okjLdHUB1sLhGyjzzijaKzUf",
      "value": 216.798875
    },
    {
      "id": "CRqyaHy3EdejLteQfU4sHH7JegbczWHK3nis33u87NHA",
      "label": "CRqyaHy3EdejLteQfU4sHH7JegbczWHK3nis33u87NHA",
      "value": 200
    },
    {
      "id": "76CPSy9bwvdBbk8W3oWrvBjiEHc7NMAn5wGNJqSfTJJN",
      "label": "76CPSy9bwvdBbk8W3oWrvBjiEHc7NMAn5wGNJqSfTJJN",
      "value": 173.864914
    },
    {
      "id": "68soqftZg4HL1Dcis5hMgkLKU9qyC8qbn5JzLhrxhgi9",
      "label": "68soqftZg4HL1Dcis5hMgkLKU9qyC8qbn5JzLhrxhgi9",
      "value": 116.96850599999999
    },
    {
      "id": "FPPHjpjBk98pd5Z3xXQuDcrZdUdqfraCRJU8yvdT1ZKR",
      "label": "FPPHjpjBk98pd5Z3xXQuDcrZdUdqfraCRJU8yvdT1ZKR",
      "value": 105.763473
    },
    {
      "id": "6g5r8saM1remgrmgitwCSn8z1258egEycPc2HW9gEaoK",
      "label": "6g5r8saM1remgrmgitwCSn8z1258egEycPc2HW9gEaoK",
      "value": 102.658205
    },
    {
      "id": "Cm1fBRb4hiwqmLknjjPmqqCJQeDprp9SCaRhAJq5wuuW",
      "label": "Cm1fBRb4hiwqmLknjjPmqqCJQeDprp9SCaRhAJq5wuuW",
      "value": 100
    },
    {
      "id": "FzgPnybZ4wqm94J118Bq94jfg3VshUe6PMAZ1ingPGt5",
      "label": "FzgPnybZ4wqm94J118Bq94jfg3VshUe6PMAZ1ingPGt5",
      "value": 75
    },
    {
      "id": "9vWhgjxpxQZusenvV1g3SrzZ1gQrimriKqLCUrig6sbM",
      "label": "9vWhgjxpxQZusenvV1g3SrzZ1gQrimriKqLCUrig6sbM",
      "value": 74.3173
    },
    {
      "id": "CSgWkLUnupL5KZxaUJkXJQkgypXrrRKcuU1jeEnCdcQy",
      "label": "CSgWkLUnupL5KZxaUJkXJQkgypXrrRKcuU1jeEnCdcQy",
      "value": 53.994791000000006
    },
    {
      "id": "ExcBWu8fGPdJiaF1b1z3iEef38sjQJks8xvj6M85pPY6",
      "label": "ExcBWu8fGPdJiaF1b1z3iEef38sjQJks8xvj6M85pPY6",
      "value": 52.64866
    },
    {
      "id": "4jDfvyyCpMgDxVwM15F7TgnyjAQApuCGQy9Nz5uRFj2H",
      "label": "4jDfvyyCpMgDxVwM15F7TgnyjAQApuCGQy9Nz5uRFj2H",
      "value": 50.422728
    },
    {
      "id": "BR9gGc9Sjthighxy8cMSdvkAv5xAdhTvJz876zYLGrGx",
      "label": "BR9gGc9Sjthighxy8cMSdvkAv5xAdhTvJz876zYLGrGx",
      "value": 50
    },
    {
      "id": "Cx7odL5r6qmYjqm1tQ8uBHtDgQpTHPkB6pgbXi4cctaN",
      "label": "Cx7odL5r6qmYjqm1tQ8uBHtDgQpTHPkB6pgbXi4cctaN",
      "value": 47.727368999999996
    },
    {
      "id": "6BTvC8EKfzRsMQkcYZ7iugixDeuVvfRBL6krh9PByCiM",
      "label": "6BTvC8EKfzRsMQkcYZ7iugixDeuVvfRBL6krh9PByCiM",
      "value": 38.45
    },
    {
      "id": "6kT4MhDqKrkWikaGpFCvYsk45BUKXEe2gTpNGAR1YcjS",
      "label": "6kT4MhDqKrkWikaGpFCvYsk45BUKXEe2gTpNGAR1YcjS",
      "value": 36.022369
    },
    {
      "id": "ANeTpNwPj4i62axSjUE4jZ7d3zvaj4sc9VFZyY1eYrtb",
      "label": "ANeTpNwPj4i62axSjUE4jZ7d3zvaj4sc9VFZyY1eYrtb",
      "value": 35.702013
    },
    {
      "id": "FGK6EwqcrJeBHcEQXLGNqKRiAYQzamJofUz67oHnQLkk",
      "label": "FGK6EwqcrJeBHcEQXLGNqKRiAYQzamJofUz67oHnQLkk",
      "value": 35.58
    },
    {
      "id": "2ujKDhasgKGZ1s7HDTzKNDfvZYJY7wZunaq6SmhipRZq",
      "label": "2ujKDhasgKGZ1s7HDTzKNDfvZYJY7wZunaq6SmhipRZq",
      "value": 35.49
    },
    {
      "id": "9GPCHKKxLh2v9NkWsTvPpuTzM1Wb4tSuUrRK1Gjx4uSP",
      "label": "9GPCHKKxLh2v9NkWsTvPpuTzM1Wb4tSuUrRK1Gjx4uSP",
      "value": 33.23799
    },
    {
      "id": "G41c1BGHECK9pWc3oZG67M7mtPc1kofnpE7EVZGU4H7p",
      "label": "G41c1BGHECK9pWc3oZG67M7mtPc1kofnpE7EVZGU4H7p",
      "value": 32.4085
    },
    {
      "id": "DEnJWmQBi88hBhCgY8xFeYFxrzLsdvfa2DZULP7htvJW",
      "label": "DEnJWmQBi88hBhCgY8xFeYFxrzLsdvfa2DZULP7htvJW",
      "value": 31.5
    },
    {
      "id": "93mnMSder8YXAex1CQPVexpgryrThJ5GfoxmHg2iSZeV",
      "label": "93mnMSder8YXAex1CQPVexpgryrThJ5GfoxmHg2iSZeV",
      "value": 28.735067
    },
    {
      "id": "9xWrwTQwxATUafswQXzgv1YAA4JG2XcyopNjRF5iDhrW",
      "label": "9xWrwTQwxATUafswQXzgv1YAA4JG2XcyopNjRF5iDhrW",
      "value": 24.16554
    },
    {
      "id": "4HSzoUiDEwrjhEsB9gv7UEzfJGm3rbaVJ2MyEztxzfrF",
      "label": "4HSzoUiDEwrjhEsB9gv7UEzfJGm3rbaVJ2MyEztxzfrF",
      "value": 21.551371
    },
    {
      "id": "BYsRjaLWmjrqodFjoHgd3JnEPXwMKAvQidCMJ3ZmWUMB",
      "label": "BYsRjaLWmjrqodFjoHgd3JnEPXwMKAvQidCMJ3ZmWUMB",
      "value": 21.2511
    },
    {
      "id": "4Esm6rvFdnqabuw4vcrTQkfAL4FSsAt4nEY26EPnJSMS",
      "label": "4Esm6rvFdnqabuw4vcrTQkfAL4FSsAt4nEY26EPnJSMS",
      "value": 21.236073
    },
    {
      "id": "D38KBTWm9oHfyVF2NnK7Xm8DHvRBhALu55PEEcXkZQEN",
      "label": "D38KBTWm9oHfyVF2NnK7Xm8DHvRBhALu55PEEcXkZQEN",
      "value": 20.927862
    },
    {
      "id": "6ZfnVD8pPRCWvC3kH7Jt13goW9i11Tjjpxm9PN9VL1PD",
      "label": "6ZfnVD8pPRCWvC3kH7Jt13goW9i11Tjjpxm9PN9VL1PD",
      "value": 20.5872
    },
    {
      "id": "7MBMPMEPHS4a9CnhLVyfF1HRPgHX4PE4izTifjWNNzHQ",
      "label": "7MBMPMEPHS4a9CnhLVyfF1HRPgHX4PE4izTifjWNNzHQ",
      "value": 14.243569
    },
    {
      "id": "82KRW1Xs2aiybcFGc8Gx2RKgtNmT12qpAxjnaUBvq9aD",
      "label": "82KRW1Xs2aiybcFGc8Gx2RKgtNmT12qpAxjnaUBvq9aD",
      "value": 12.729503
    },
    {
      "id": "3RndMfrRY266KUdCeQxLd7pxSuMjVmaoGHgzQHKEiQ2y",
      "label": "3RndMfrRY266KUdCeQxLd7pxSuMjVmaoGHgzQHKEiQ2y",
      "value": 9.6417
    },
    {
      "id": "6owFZMF2gJQPVCRXX39nWF46wckTiRgxJQRJDBaryyUL",
      "label": "6owFZMF2gJQPVCRXX39nWF46wckTiRgxJQRJDBaryyUL",
      "value": 9.258111
    },
    {
      "id": "B6LL9aCWVuo1tTcJoYvCTDqYrq1vjMfci8uHxsm4UxTR",
      "label": "B6LL9aCWVuo1tTcJoYvCTDqYrq1vjMfci8uHxsm4UxTR",
      "value": 8.871662
    },
    {
      "id": "GkUbkNnMFzPXzu8Rf7qv9MuNAm2n6C3y8E7V8CBzw2Qq",
      "label": "GkUbkNnMFzPXzu8Rf7qv9MuNAm2n6C3y8E7V8CBzw2Qq",
      "value": 7.02322
    },
    {
      "id": "2Rv4ZTUuFpvBub2jJRgAe2XK6BYbVX4f6YJGzQqnpyhS",
      "label": "2Rv4ZTUuFpvBub2jJRgAe2XK6BYbVX4f6YJGzQqnpyhS",
      "value": 6.434999999999997
    },
    {
      "id": "F5oK5zdyUktrzTgSJdBFL73xUdCLcHfHfHdBcpydhXoK",
      "label": "F5oK5zdyUktrzTgSJdBFL73xUdCLcHfHfHdBcpydhXoK",
      "value": 5.99338
    },
    {
      "id": "BuStJqGeVx9VEnBmhVGkVW3uzwcWJzNFyTU8ueezmum7",
      "label": "BuStJqGeVx9VEnBmhVGkVW3uzwcWJzNFyTU8ueezmum7",
      "value": 4.0194
    },
    {
      "id": "94QRYGvh2pqg5c1qMxt4CghzJYp8Ap9TfaRuBUTjrMH8",
      "label": "94QRYGvh2pqg5c1qMxt4CghzJYp8Ap9TfaRuBUTjrMH8",
      "value": 2.836879
    },
    {
      "id": "HAPPNCH9iHLGvZ89s6tNW2zZdQ4qEN2t7Yxt4tLyTjVB",
      "label": "HAPPNCH9iHLGvZ89s6tNW2zZdQ4qEN2t7Yxt4tLyTjVB",
      "value": 2.741047
    },
    {
      "id": "Fsqcr2cWSN4s4ni7cyas4YSaV8hnLL6MoKFkQdV83Srx",
      "label": "Fsqcr2cWSN4s4ni7cyas4YSaV8hnLL6MoKFkQdV83Srx",
      "value": 1.7
    },
    {
      "id": "FkskH3gNDpt4j4UPVCV9pU7PaterGHezfsoFixzhuvuv",
      "label": "FkskH3gNDpt4j4UPVCV9pU7PaterGHezfsoFixzhuvuv",
      "value": 1.0593
    },
    {
      "id": "6L7HS9PksrNcxpa9MjQX38gmidi2vsXChzBKtmk56MY3",
      "label": "6L7HS9PksrNcxpa9MjQX38gmidi2vsXChzBKtmk56MY3",
      "value": 1.030818
    },
    {
      "id": "8FeybF5Bt1XxPQ6Q5UXy3myNnJF6HGiV21aNBrphLgta",
      "label": "8FeybF5Bt1XxPQ6Q5UXy3myNnJF6HGiV21aNBrphLgta",
      "value": 0.19609099999999996
    },
    {
      "id": "FX25xTPZLPrKohSmfGRRRKGDZTbwt7GYe5Gj8bz321cx",
      "label": "FX25xTPZLPrKohSmfGRRRKGDZTbwt7GYe5Gj8bz321cx",
      "value": 0.14162600000000003
    },
    {
      "id": "Gg8DjNxSJbPCToHMcuGvcukAidvmhya5RmtudcFVGFH3",
      "label": "Gg8DjNxSJbPCToHMcuGvcukAidvmhya5RmtudcFVGFH3",
      "value": 0.019818
    },
    {
      "id": "2dc3UgMuVkASzW4sABDjDB5PjFbPTncyECUnZL73bmQR",
      "label": "2dc3UgMuVkASzW4sABDjDB5PjFbPTncyECUnZL73bmQR",
      "value": 0.019809
    },
    {
      "id": "CyrzGrL9U9x9FfqfQiTi7kWsvJ9mK97tGxtPF1AV8E8d",
      "label": "CyrzGrL9U9x9FfqfQiTi7kWsvJ9mK97tGxtPF1AV8E8d",
      "value": 0.011412
    },
    {
      "id": "5C1k9yV7y4CjMnKv8eGYDgWND8P89Pdfj79Trk2qmfGo",
      "label": "5C1k9yV7y4CjMnKv8eGYDgWND8P89Pdfj79Trk2qmfGo",
      "value": 0.010896000000000001
    },
    {
      "id": "3Hwf5E7w71EfTk5EAZHAMFnndVdLEv9Gk9tymxFJgwDv",
      "label": "3Hwf5E7w71EfTk5EAZHAMFnndVdLEv9Gk9tymxFJgwDv",
      "value": 0.009898
    },
    {
      "id": "2w4A1eGyjRutakyFdmVyBiLPf98qKxNTC2LpuwhaCruZ",
      "label": "2w4A1eGyjRutakyFdmVyBiLPf98qKxNTC2LpuwhaCruZ",
      "value": 0.009896
    }
  ],
  "links": [
    {
      "source": "7C7Y3fyPYeAYqpc29uahDUQ84PQ255Avj2YEP9KpvyKx",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 238746.35638499996,
      "count": 70
    },
    {
      "source": "ExwyJ1D3F4RwaRvpGhmendPFK7Jfiqjh7a1TcQzt4Sq",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 20211.689059,
      "count": 2
    },
    {
      "source": "8sJpY3PDTpSdaHrWmJ2woAXQJLHs1S4HQxcEcievcoLo",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 8823.532621999999,
      "count": 2
    },
    {
      "source": "FkEB6uvyzuoaGpgs4yRtFtxC4WJxhejNFbUkj5R6wR32",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 7789.233826000001,
      "count": 43
    },
    {
      "source": "6ZaWyb9PKP1ZGVsQcE9vjnGPCH6KiWE5XLUY7HdNEJ77",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 7246.043169,
      "count": 7
    },
    {
      "source": "7imnGYfCovXjMWKdbQvETFVMe72MQDX4S5zW4GFxMJME",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 6928.347925,
      "count": 26
    },
    {
      "source": "FDJKUgZniCHAgzeDfcx1rvhHZER1yEnnyvFRvMuofiSP",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 6760.066474,
      "count": 2
    },
    {
      "source": "4BXpSHpJa6EbgQgGWV8bQVw9t1VijGXBXzYY8m6v969V",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 4422.46426,
      "count": 41
    },
    {
      "source": "E6xrCvWbvX8DNuCp5ztKdhFPv3AZisGre8FtTx4DCNTF",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 4256.6710969999995,
      "count": 4
    },
    {
      "source": "6y33H5c1FUYego5mL9CghGrqj77PC7ieevMyuNqbCvfP",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 3013.1566729999995,
      "count": 14
    },
    {
      "source": "BXh9wNMJ9g3tCKgjr9E9KiSa7VRdDKspXh1uYEEA6xhW",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 2999.4,
      "count": 1
    },
    {
      "source": "22HUWiJaTNph96KQTKZVy2wg8KzfCems5nyW7E5H5J6w",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 1918.668022,
      "count": 16
    },
    {
      "source": "3nMFwZXwY1s1M5s8vYAHqd4wGs4iSxXE4LRoUMMYqEgF",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 1104.814665,
      "count": 8
    },
    {
      "source": "4SAZfdHATLCgdtCArEAryxcvRWEKFmPuEqr72hyCRLJt",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 1025,
      "count": 1
    },
    {
      "source": "2B24UFbvKwSqAzsqZX9rad2gqFmNoeE6B8uCFW6tpEzY",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 1000.5,
      "count": 1
    },
    {
      "source": "F8A9VK67WeWKruZfBxRRuZUsQ9BZnBFF4A35bx976ob5",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 900,
      "count": 1
    },
    {
      "source": "4ZgJn35Y1h1jWdv4iYdyjphPk4ZaMi8FgoLw17wGBHm3",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 850,
      "count": 1
    },
    {
      "source": "7o67HYcMuKAUWq1PF4B1SKG9HesR7u9N3ukuFxhKXFfh",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 605.182583,
      "count": 1
    },
    {
      "source": "CtshJv4S924Lkdh8uvcQDEtUv4WDTZrVpND7cYP2tMPZ",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 604.874603,
      "count": 1
    },
    {
      "source": "F2oSLY4gXwi4cLFripL15iTSZczhkKzYfbRhs2PdAQxy",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 600,
      "count": 1
    },
    {
      "source": "3NrRxkTvbW3dpGu9JBCeY6PvY6J9Vg4BUhqETvGCSm7c",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 532,
      "count": 1
    },
    {
      "source": "7gEQ6syDZmyPE4JdfJm4qatawnDqvqdh6i8jJjCXio6h",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 362,
      "count": 9
    },
    {
      "source": "FwewVm8u6tFPGewAyHmWAqad9hmF7mvqxK4mJ7iNqqGC",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 342.581175,
      "count": 4
    },
    {
      "source": "HQCbyLb9zzFQENNhsuZ2cbMScevAYzyJPeRhsDZuYgup",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 300,
      "count": 1
    },
    {
      "source": "F7p3dFrjRTbtRp8FRF6qHLomXbKRBzpvBLjtQcfcgmNe",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 289.399784,
      "count": 1
    },
    {
      "source": "GF8SKKobum6UJnhX2mLHePU38htg5vdr9zcY4jH8Pqs2",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 233.96793700000003,
      "count": 12
    },
    {
      "source": "Fm4NdDhcrS9a8ceHJGe6okjLdHUB1sLhGyjzzijaKzUf",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 216.798875,
      "count": 1
    },
    {
      "source": "CRqyaHy3EdejLteQfU4sHH7JegbczWHK3nis33u87NHA",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 200,
      "count": 2
    },
    {
      "source": "76CPSy9bwvdBbk8W3oWrvBjiEHc7NMAn5wGNJqSfTJJN",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 173.864914,
      "count": 1
    },
    {
      "source": "68soqftZg4HL1Dcis5hMgkLKU9qyC8qbn5JzLhrxhgi9",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 116.96850599999999,
      "count": 6
    },
    {
      "source": "FPPHjpjBk98pd5Z3xXQuDcrZdUdqfraCRJU8yvdT1ZKR",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 105.763473,
      "count": 1
    },
    {
      "source": "6g5r8saM1remgrmgitwCSn8z1258egEycPc2HW9gEaoK",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 102.658205,
      "count": 1
    },
    {
      "source": "Cm1fBRb4hiwqmLknjjPmqqCJQeDprp9SCaRhAJq5wuuW",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 100,
      "count": 1
    },
    {
      "source": "FzgPnybZ4wqm94J118Bq94jfg3VshUe6PMAZ1ingPGt5",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 75,
      "count": 1
    },
    {
      "source": "9vWhgjxpxQZusenvV1g3SrzZ1gQrimriKqLCUrig6sbM",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 74.3173,
      "count": 1
    },
    {
      "source": "CSgWkLUnupL5KZxaUJkXJQkgypXrrRKcuU1jeEnCdcQy",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 53.994791000000006,
      "count": 3
    },
    {
      "source": "ExcBWu8fGPdJiaF1b1z3iEef38sjQJks8xvj6M85pPY6",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 52.64866,
      "count": 5
    },
    {
      "source": "4jDfvyyCpMgDxVwM15F7TgnyjAQApuCGQy9Nz5uRFj2H",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 50.422728,
      "count": 1
    },
    {
      "source": "BR9gGc9Sjthighxy8cMSdvkAv5xAdhTvJz876zYLGrGx",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 50,
      "count": 1
    },
    {
      "source": "Cx7odL5r6qmYjqm1tQ8uBHtDgQpTHPkB6pgbXi4cctaN",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 47.727368999999996,
      "count": 2
    },
    {
      "source": "6BTvC8EKfzRsMQkcYZ7iugixDeuVvfRBL6krh9PByCiM",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 38.45,
      "count": 1
    },
    {
      "source": "6kT4MhDqKrkWikaGpFCvYsk45BUKXEe2gTpNGAR1YcjS",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 36.022369,
      "count": 2
    },
    {
      "source": "ANeTpNwPj4i62axSjUE4jZ7d3zvaj4sc9VFZyY1eYrtb",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 35.702013,
      "count": 1
    },
    {
      "source": "FGK6EwqcrJeBHcEQXLGNqKRiAYQzamJofUz67oHnQLkk",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 35.58,
      "count": 1
    },
    {
      "source": "2ujKDhasgKGZ1s7HDTzKNDfvZYJY7wZunaq6SmhipRZq",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 35.49,
      "count": 1
    },
    {
      "source": "9GPCHKKxLh2v9NkWsTvPpuTzM1Wb4tSuUrRK1Gjx4uSP",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 33.23799,
      "count": 1
    },
    {
      "source": "G41c1BGHECK9pWc3oZG67M7mtPc1kofnpE7EVZGU4H7p",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 32.4085,
      "count": 1
    },
    {
      "source": "DEnJWmQBi88hBhCgY8xFeYFxrzLsdvfa2DZULP7htvJW",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 31.5,
      "count": 1
    },
    {
      "source": "93mnMSder8YXAex1CQPVexpgryrThJ5GfoxmHg2iSZeV",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 28.735067,
      "count": 4
    },
    {
      "source": "9xWrwTQwxATUafswQXzgv1YAA4JG2XcyopNjRF5iDhrW",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 24.16554,
      "count": 1
    },
    {
      "source": "4HSzoUiDEwrjhEsB9gv7UEzfJGm3rbaVJ2MyEztxzfrF",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 21.551371,
      "count": 1
    },
    {
      "source": "BYsRjaLWmjrqodFjoHgd3JnEPXwMKAvQidCMJ3ZmWUMB",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 21.2511,
      "count": 1
    },
    {
      "source": "4Esm6rvFdnqabuw4vcrTQkfAL4FSsAt4nEY26EPnJSMS",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 21.236073,
      "count": 1
    },
    {
      "source": "D38KBTWm9oHfyVF2NnK7Xm8DHvRBhALu55PEEcXkZQEN",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 20.927862,
      "count": 1
    },
    {
      "source": "6ZfnVD8pPRCWvC3kH7Jt13goW9i11Tjjpxm9PN9VL1PD",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 20.5872,
      "count": 1
    },
    {
      "source": "7MBMPMEPHS4a9CnhLVyfF1HRPgHX4PE4izTifjWNNzHQ",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 14.243569,
      "count": 2
    },
    {
      "source": "82KRW1Xs2aiybcFGc8Gx2RKgtNmT12qpAxjnaUBvq9aD",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 12.729503,
      "count": 2
    },
    {
      "source": "3RndMfrRY266KUdCeQxLd7pxSuMjVmaoGHgzQHKEiQ2y",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 9.6417,
      "count": 1
    },
    {
      "source": "6owFZMF2gJQPVCRXX39nWF46wckTiRgxJQRJDBaryyUL",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 9.258111,
      "count": 1
    },
    {
      "source": "B6LL9aCWVuo1tTcJoYvCTDqYrq1vjMfci8uHxsm4UxTR",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 8.871662,
      "count": 1
    },
    {
      "source": "GkUbkNnMFzPXzu8Rf7qv9MuNAm2n6C3y8E7V8CBzw2Qq",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 7.02322,
      "count": 1
    },
    {
      "source": "2Rv4ZTUuFpvBub2jJRgAe2XK6BYbVX4f6YJGzQqnpyhS",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 6.434999999999997,
      "count": 26
    },
    {
      "source": "F5oK5zdyUktrzTgSJdBFL73xUdCLcHfHfHdBcpydhXoK",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 5.99338,
      "count": 1
    },
    {
      "source": "BuStJqGeVx9VEnBmhVGkVW3uzwcWJzNFyTU8ueezmum7",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 4.0194,
      "count": 1
    },
    {
      "source": "94QRYGvh2pqg5c1qMxt4CghzJYp8Ap9TfaRuBUTjrMH8",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 2.836879,
      "count": 1
    },
    {
      "source": "HAPPNCH9iHLGvZ89s6tNW2zZdQ4qEN2t7Yxt4tLyTjVB",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 2.741047,
      "count": 1
    },
    {
      "source": "Fsqcr2cWSN4s4ni7cyas4YSaV8hnLL6MoKFkQdV83Srx",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 1.7,
      "count": 1
    },
    {
      "source": "FkskH3gNDpt4j4UPVCV9pU7PaterGHezfsoFixzhuvuv",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 1.0593,
      "count": 1
    },
    {
      "source": "6L7HS9PksrNcxpa9MjQX38gmidi2vsXChzBKtmk56MY3",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 1.030818,
      "count": 2
    },
    {
      "source": "8FeybF5Bt1XxPQ6Q5UXy3myNnJF6HGiV21aNBrphLgta",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 0.19609099999999996,
      "count": 18
    },
    {
      "source": "FX25xTPZLPrKohSmfGRRRKGDZTbwt7GYe5Gj8bz321cx",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 0.14162600000000003,
      "count": 13
    },
    {
      "source": "Gg8DjNxSJbPCToHMcuGvcukAidvmhya5RmtudcFVGFH3",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 0.019818,
      "count": 2
    },
    {
      "source": "2dc3UgMuVkASzW4sABDjDB5PjFbPTncyECUnZL73bmQR",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 0.019809,
      "count": 2
    },
    {
      "source": "CyrzGrL9U9x9FfqfQiTi7kWsvJ9mK97tGxtPF1AV8E8d",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 0.011412,
      "count": 2
    },
    {
      "source": "5C1k9yV7y4CjMnKv8eGYDgWND8P89Pdfj79Trk2qmfGo",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 0.010896000000000001,
      "count": 2
    },
    {
      "source": "3Hwf5E7w71EfTk5EAZHAMFnndVdLEv9Gk9tymxFJgwDv",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 0.009898,
      "count": 1
    },
    {
      "source": "2w4A1eGyjRutakyFdmVyBiLPf98qKxNTC2LpuwhaCruZ",
      "target": "CapuXNQoDviLvU1PxFiizLgPNQCxrsag1uMeyk6zLVps",
      "value": 0.009896,
      "count": 1
    }
  ]
};
const nodes = data.nodes.map(d => ({ ...d }));
const links = data.links.map(d => ({ ...d }));

const valueExtent = d3.extent(nodes, d => d.value);
const r = d3.scaleSqrt().domain([Math.max(1, valueExtent[0] || 1), valueExtent[1] || 1]).range([3, 36]);
const w = d3.scaleSqrt().domain(d3.extent(links, d => d.value)).range([0.2, 6]);
const color = d3.scaleSequential(d3.interpolateTurbo).domain(d3.extent(nodes, d => d.value).reverse());
const fmtShort = d3.format(".3s");
const fmtFull = d3.format(",.2f");

const link = svg.append('g')
  .attr('stroke-linecap', 'round')
  .selectAll('line')
  .data(links)
  .join('line')
  .attr('class', 'link')
  .attr('stroke-width', d => w(d.value));

const node = svg.append('g')
  .selectAll('circle')
  .data(nodes)
  .join('circle')
  .attr('class', 'node')
  .attr('r', d => r(d.value))
  .attr('fill', d => color(d.value))
  .call(d3.drag()
    .on('start', (event, d) => { if (!event.active) sim.alphaTarget(0.3).restart(); d.fx = d.x; d.fy = d.y; })
    .on('drag', (event, d) => { d.fx = event.x; d.fy = event.y; })
    .on('end', (event, d) => { if (!event.active) sim.alphaTarget(0); d.fx = null; d.fy = null; })
  );

node.append('title')
  .text(d => `${d.id}\n$${d3.format(",.2f")(d.value)}`);

// Build quick stats for tooltip
const inCount = new Map();
const outCount = new Map();
const totalLinkUsd = new Map();
for (const l of links) {
  outCount.set(l.source, (outCount.get(l.source) || 0) + 1);
  inCount.set(l.target, (inCount.get(l.target) || 0) + 1);
  totalLinkUsd.set(l.source, (totalLinkUsd.get(l.source) || 0) + (l.value || 0));
  totalLinkUsd.set(l.target, (totalLinkUsd.get(l.target) || 0) + (l.value || 0));
}

const tooltip = d3.select('#tooltip');
function positionTooltip(event) {
  const pad = 12;
  const vw = window.innerWidth;
  const vh = window.innerHeight;
  const tw = tooltip.node().offsetWidth || 240;
  const th = tooltip.node().offsetHeight || 100;
  let x = event.clientX + pad;
  let y = event.clientY + pad;
  if (x + tw + pad > vw) x = event.clientX - tw - pad;
  if (y + th + pad > vh) y = event.clientY - th - pad;
  tooltip.style('left', x + 'px').style('top', y + 'px');
}

node
  .on('mouseenter', (event, d) => {
    const incoming = inCount.get(d.id) || 0;
    const outgoing = outCount.get(d.id) || 0;
    const linkUsd = totalLinkUsd.get(d.id) || 0;
    tooltip
      .style('display', 'block')
      .html(
        `<div class="title">${d.label}</div>`+
        `<div class="row"><span class="muted">Node USD</span><span>$${fmtFull(d.value)}</span></div>`+
        `<div class="row"><span class="muted">Connected edges</span><span>${incoming + outgoing} (in ${incoming} / out ${outgoing})</span></div>`+
        `<div class="row"><span class="muted">Total linked USD</span><span>$${fmtShort(linkUsd)}</span></div>`
      );
    positionTooltip(event);
  })
  .on('mousemove', (event) => positionTooltip(event))
  .on('mouseleave', () => tooltip.style('display', 'none'));

// Show labels only for sufficiently large nodes to reduce clutter
// Set to always return false to hide all labels - use tooltips instead
const showLabel = d => false;
const label = svg.append('g')
  .selectAll('text')
  .data(nodes.filter(showLabel))
  .join('text')
  .attr('class', 'label')
  .attr('text-anchor', 'middle')
  .each(function(d) {
    const el = d3.select(this);
    // First line: short address
    el.append('tspan')
      .attr('x', 0)
      .attr('dy', 0)
      .text(d.label.slice(0, 4) + '…' + d.label.slice(-4));
    // Second line: compact USD amount
    el.append('tspan')
      .attr('x', 0)
      .attr('dy', 12)
      .text('$' + fmtShort(d.value));
  });

const sim = d3.forceSimulation(nodes)
  .force('link', d3.forceLink(links).id(d => d.id).distance(d => 40 + 2 * Math.sqrt(r(d.source?.value || 1) + r(d.target?.value || 1))))
  .force('charge', d3.forceManyBody().strength(-120))
  .force('collision', d3.forceCollide().radius(d => r(d.value) + 2))
  .force('center', d3.forceCenter(width / 2, height / 2))
  .on('tick', () => {
    link
      .attr('x1', d => d.source.x)
      .attr('y1', d => d.source.y)
      .attr('x2', d => d.target.x)
      .attr('y2', d => d.target.y);
    node.attr('cx', d => d.x).attr('cy', d => d.y);
    label
      .attr('x', d => d.x)
      // place label just above the bubble
      .attr('y', d => d.y - r(d.value) - 6);
  });

window.addEventListener('resize', () => {
  const wv = window.innerWidth, hv = window.innerHeight;
  svg.attr('width', wv).attr('height', hv);
  sim.force('center', d3.forceCenter(wv / 2, hv / 2)).alpha(0.3).restart();
});
</script>


